<div class="box user-reg" style="display:none;padding:0px;">
	<form action="__AJAX__/user/add" method="post" id="js-regForm" onsubmit="return doReg(this);">
		<div class="left">
			<div class="left_yi"><span style="font-size:18px;">注册</span>&nbsp;已有账户?&nbsp;<a style="color:#c74396;" href="#">立即登录</a></div>
			<div class="left_er">
				<input onblur="checkuser()" id="js-user-email" onfocus="if (value =='登录邮箱'){value =''}" class="kuang" name="email" value="登录邮箱" tabindex="1" type="text" style="">
			</div>
			<div class="left_san" id="js-email-error">填写您的登录邮箱</div>
			<div class="left_er"><input onblur="pwStrength(this.value,'onblur')" id="js-password" onkeyup="pwStrength(this.value)" class="kuang2" name="password"  tabindex="1"  type="password" style=""></div>
			<div class="right2_yi">
				<div class="right2_yi_zuo"><a href="#"><img src="__RESOURCE__/images/ruo1.jpg" alt=""></a></div>
				<div class="right2_yi_zhong"><a href="#"><img src="__RESOURCE__/images/zhong.jpg" alt=""></a></div>
				<div class="right2_yi_you"><a href="#"><img src="__RESOURCE__/images/qiang.jpg" alt=""></a></div>
			</div>
			<div class="left_san" id="js-pass-error"></div>
			<div style="margin-top:20px;" class="left_er">
				<input class="kuang2"  onmouseout="this.style.borderColor=''" onfocus="checkRePassword(this)" value="验证" onmouseover="this.style.borderColor=''" tabindex="1"  onblur="rePasswordBlur(this)" type="text" style="">
			</div>
			<div class="left_wu2">
				<div class="left_wu_left"><a href="#"><input type="image"  name="btn_submit" src="__RESOURCE__/images/61-33-.jpg" /></a></div>
				<div class="left_wu_right2"><input name="agreement" class="agreement" type="checkbox" value="ok" checked="">同意<a href="#">用户协议</a></div>
			</div>
			<div class="left_san" id="agreement"></div>
		</div>
	</form>
	<div class="right">
		<div class="right_yi"><a href="javascript:;" onclick="$.mask.close()" id="js-reg-close"><img src="__RESOURCE__/images/7-8.png" alt=""></a></div>
		<div class="right_er">使用合作账号登录</div>
		<div class="right_san2">
			<div class="right_san2_zuo"><a href="#"><img src="__RESOURCE__/images/52-52-tao.png" alt=""></a></div>
			<div class="right_san2_zhong"><a href="#"><img src="__RESOURCE__/images/52-52-wei.png" alt=""></a></div>
			<div class="right_san2_you"><a href="#"><img src="__RESOURCE__/images/52-52-qq.png" alt=""></a></div>
		</div>
		<div class="right_zi">
			<ul>
				<li><a href="#">淘宝</a></li>
				<li><a href="#">微博</a></li>
				<li><a href="#">QQ</a></li>
			</ul>
		</div>
	</div>
</div>
<script>

var isOk = true;

function doReg(obj) {
	$(obj).ajaxSubmit({
		dataType: 'json',
		success: function(data) {
			if (data.result) {
				window.location.href = '__APP__/user/change';
			}
		}
	});
	return false;
}

function checkRePassword(obj) {
	obj.type = 'password';
	if (obj.value =='验证') {
		obj.value = ''
	}
}

function rePasswordBlur(obj) {
	var password = $('#js-password').val();
	if (obj.value == '') {
		obj.value='验证'
		obj.type = 'text';
	}
	else if (obj.value != password) {
		$('#js-pass-error').html('两次密码输入的不一致');
		$(obj).css('border-color','#E872C0');
	}
}

function checkuser() {
	obj = $('#js-user-email');
	var name = obj.val();
	if (!name || name == '登录邮箱') {
		$('#js-email-error').html('请填写email');
		obj.css('border-color','#E872C0');
		if (name =='') {
			obj.val('登录邮箱');
		}
		return false;
	}
	
	var data = {name:name};
	var url  = '__AJAX__/user/checkuser?stmp'+Math.random();
	$.ajax({
		type:'get',
		url:url,
		data:data,
		dataType:'json',
		success:function(data){
			if (data.result) {
				$('#js-email-error').html('<font color="green">用户名可用</font>');
				$(obj).css('border-color','#cdcdcd');
			}
			else {
				$('#js-email-error').html(data.error.message);
				$(obj).css('border-color','#E872C0');
			}
		}
	});
}

function checkverify(value) {
	if (value ==''){value='验证码'}
	var data = {verify:value};
	var url  = '__AJAX__/user/checkverify?stmp'+Math.random();
	$.ajax({
		type:'get',
		url:url,
		data:data,
		dataType:'json',
		success:function(data){
			if (data.result) {
				$('.kuang3').css('border-color','#cdcdcd');
				$('#verify').html('');
			}
			else {
				$('#verify').html('<font color="#E872C0">'+data.error.message+'</font>');
				$('.kuang3').css('border-color','#E872C0');
			}
		}
	});
}
//CharMode函数 
//测试某个字符是属于哪一类. 
function CharMode(iN) {
	if (iN >= 48 && iN <= 57) //数字 
		return 1;
	if (iN >= 65 && iN <= 90) //大写字母 
		return 2;
	if (iN >= 97 && iN <= 122) //小写 
		return 4;
	else
		return 8; //特殊字符 
}
//bitTotal函数 
//计算出当前密码当中一共有多少种模式 
function bitTotal(num) {
	modes = 0;
	for (i = 0; i < 4; i++) {
		if (num & 1) modes++;
		num >>>= 1;
	}
	return modes;
}
//checkStrong函数 
//返回密码的强度级别 
function checkStrong(sPW) {
	if (sPW.length <= 4)
		return 0; //密码太短 
	Modes = 0;
	for (i = 0; i < sPW.length; i++) {
		//测试每一个字符的类别并统计一共有多少种模式. 
		Modes |= CharMode(sPW.charCodeAt(i));
	}
	return bitTotal(Modes);
}
//pwStrength函数 
//当用户放开键盘或密码输入框失去焦点时，根据不同的级别显示不同的颜色 
function pwStrength(pwd, type) {
	if (pwd == null || pwd == '') {
		$(".right2_yi_zuo").html('<img src="__RESOURCE__/images/ruo1.jpg">');
		$(".right2_yi_zhong").html('<img src="__RESOURCE__/images/zhong.jpg">');
		$(".right2_yi_you").html('<img src="__RESOURCE__/images/qiang.jpg">');
		$('#js-pass-error').html('请填写密码');
		$('#js-password').css('border-color','#E872C0');
	}
	else if (type && type == 'onblur' && pwd.length < 6) {
		$('#js-pass-error').html('密码不能低于6位');
		$('#password').css('border-color','#E872C0');
	}
	else if(pwd.length > 32) {
		$('#js-pass-error').html('密码不能超过32位');
		$('#password').css('border-color','#E872C0');
	}
	else {
		$('#js-pass-error').html('');	
		$('#js-password').css('border-color','#cdcdcd');
		S_level = checkStrong(pwd);
		switch (S_level) {
			case 0:
				$(".right2_yi_zuo").html('<img src="__RESOURCE__/images/ruo1.jpg">');
				$(".right2_yi_zhong").html('<img src="__RESOURCE__/images/zhong.jpg">');
				$(".right2_yi_you").html('<img src="__RESOURCE__/images/qiang.jpg">');
			case 1:
				$(".right2_yi_zuo").html('<img src="__RESOURCE__/images/ruo1.jpg">');
				$(".right2_yi_zhong").html('<img src="__RESOURCE__/images/zhong.jpg">');
				$(".right2_yi_you").html('<img src="__RESOURCE__/images/qiang.jpg">');
				break;
			case 2:		 
			   $(".right2_yi_zuo").html('<img src="__RESOURCE__/images/ruo.gif">');
			   $(".right2_yi_you").html('<img src="__RESOURCE__/images/qiang.jpg">');
			   $(".right2_yi_zhong").html('<img src="__RESOURCE__/images/zhong1.gif">');
				break;
			default:
				$(".right2_yi_zuo").html('<img src="__RESOURCE__/images/ruo.gif">');
				$(".right2_yi_zhong").html('<img src="__RESOURCE__/images/zhong.jpg">');
				$(".right2_yi_you").html('<img src="__RESOURCE__/images/qiang1.gif">');
		}
	}
} 
</script>